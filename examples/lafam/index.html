<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>LaFAM Live Demo</title>

    <link rel="stylesheet" href="index.css">
</head>

<body data-new-gr-c-s-check-loaded="14.1155.0" data-gr-ext-installed="">

    <section id="main-section" class="main-section paused">
        <div class="canvas-block card">
            <div class="canvas-wrapper">
                <div id="loading-indicator" class="loading">

                    <svg xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
                        <path
                            d="M304 48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zm0 416a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM48 304a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm464-48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM142.9 437A48 48 0 1 0 75 369.1 48 48 0 1 0 142.9 437zm0-294.2A48 48 0 1 0 75 75a48 48 0 1 0 67.9 67.9zM369.1 437A48 48 0 1 0 437 369.1 48 48 0 1 0 369.1 437z" />
                    </svg>
                    <div id="loading-text">Initializing...</div>
                </div>
                <canvas id="img-canvas" width="1024" height="1024"></canvas>
                <canvas id="heatmap-canvas" width="1024" height="1024"></canvas>
                <canvas id="bounding-boxes-canvas" width="1024" height="1024"></canvas>
                <div id="grid">
                    <div data-idx="0"></div>
                    <div data-idx="1"></div>
                    <div data-idx="2"></div>
                    <div data-idx="3"></div>
                    <div data-idx="4"></div>
                    <div data-idx="5"></div>
                    <div data-idx="6"></div>
                    <div data-idx="7"></div>
                    <div data-idx="8"></div>
                    <div data-idx="9"></div>
                    <div data-idx="10"></div>
                    <div data-idx="11"></div>
                    <div data-idx="12"></div>
                    <div data-idx="13"></div>
                    <div data-idx="14"></div>
                    <div data-idx="15"></div>
                    <div data-idx="16"></div>
                    <div data-idx="17"></div>
                    <div data-idx="18"></div>
                    <div data-idx="19"></div>
                    <div data-idx="20"></div>
                    <div data-idx="21"></div>
                    <div data-idx="22"></div>
                    <div data-idx="23"></div>
                    <div data-idx="24"></div>
                    <div data-idx="25"></div>
                    <div data-idx="26"></div>
                    <div data-idx="27"></div>
                    <div data-idx="28"></div>
                    <div data-idx="29"></div>
                    <div data-idx="30"></div>
                    <div data-idx="31"></div>
                    <div data-idx="32"></div>
                    <div data-idx="33"></div>
                    <div data-idx="34"></div>
                    <div data-idx="35"></div>
                    <div data-idx="36"></div>
                    <div data-idx="37"></div>
                    <div data-idx="38"></div>
                    <div data-idx="39"></div>
                    <div data-idx="40"></div>
                    <div data-idx="41"></div>
                    <div data-idx="42"></div>
                    <div data-idx="43"></div>
                    <div data-idx="44"></div>
                    <div data-idx="45"></div>
                    <div data-idx="46"></div>
                    <div data-idx="47"></div>
                    <div data-idx="48"></div>
                </div>
            </div>
        </div>
        <div class="record-block">
            <div class="card">
                <div class="button-group">
                    <!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
                    <button id="start-button" class="btn" disabled>
                        <svg class="play-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"
                            fill="currentColor">
                            <path
                                d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z" />
                        </svg>
                        <svg class="pause-icon" xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                            viewBox="0 0 320 512">
                            <path
                                d="M48 64C21.5 64 0 85.5 0 112V400c0 26.5 21.5 48 48 48H80c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H48zm192 0c-26.5 0-48 21.5-48 48V400c0 26.5 21.5 48 48 48h32c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H240z" />
                        </svg>
                    </button>
                    <button id="switch-camera-button" class="btn" disabled>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" fill="currentColor">
                            <path
                                d="M213.1 64.8L202.7 96H128c-35.3 0-64 28.7-64 64V416c0 35.3 28.7 64 64 64H512c35.3 0 64-28.7 64-64V160c0-35.3-28.7-64-64-64H437.3L426.9 64.8C420.4 45.2 402.1 32 381.4 32H258.6c-20.7 0-39 13.2-45.5 32.8zM448 256c0 8.8-7.2 16-16 16H355.3c-6.2 0-11.3-5.1-11.3-11.3c0-3 1.2-5.9 3.3-8L371 229c-13.6-13.4-31.9-21-51-21c-19.2 0-37.7 7.6-51.3 21.3L249 249c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l19.7-19.7C257.4 172.7 288 160 320 160c31.8 0 62.4 12.6 85 35l23.7-23.7c2.1-2.1 5-3.3 8-3.3c6.2 0 11.3 5.1 11.3 11.3V256zM192 320c0-8.8 7.2-16 16-16h76.7c6.2 0 11.3 5.1 11.3 11.3c0 3-1.2 5.9-3.3 8L269 347c13.6 13.4 31.9 21 51 21c19.2 0 37.7-7.6 51.3-21.3L391 327c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-19.7 19.7C382.6 403.3 352 416 320 416c-31.8 0-62.4-12.6-85-35l-23.7 23.7c-2.1 2.1-5 3.3-8 3.3c-6.2 0-11.3-5.1-11.3-11.3V320z" />
                        </svg>
                    </button>
                    <div class="upload-wrapper">
                        <input type="file" id="upload-input" accept="image/*" style="display: none;">
                        <div id="upload-button">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
                                <path
                                    d="M88.7 223.8L0 375.8V96C0 60.7 28.7 32 64 32H181.5c17 0 33.3 6.7 45.3 18.7l26.5 26.5c12 12 28.3 18.7 45.3 18.7H416c35.3 0 64 28.7 64 64v32H144c-22.8 0-43.8 12.1-55.3 31.8zm27.6 16.1C122.1 230 132.6 224 144 224H544c11.5 0 22 6.1 27.7 16.1s5.7 22.2-.1 32.1l-112 192C453.9 474 443.4 480 432 480H32c-11.5 0-22-6.1-27.7-16.1s-5.7-22.2 .1-32.1l112-192z" />
                            </svg>
                        </div>
                        <select id="predefined-files">
                            <option value="" disabled selected hidden></option>
                            <option value="dog_and_cat.jpg">Dog & Cat</option>
                            <option value="self-driving.png">Self-driving car</option>
                            <option value="misc.png">Misc</option>
                        </select>
                    </div>
                    <div class="select-wrapper" style="gap: 10px;">
                        <select id="palette-select" class="lafam-select">

                        </select>

                        <select id="mode-select" class="lafam-select">
                            <option value="predict" selected>Predict</option>
                            <option value="imagenet-classes">Imagenet Classes</option>
                            <option value="groupmap-bbs">Groups + Bounding Boxes</option>
                            <!-- option value="predict_squares_for_bounding_boxes">Show Bounding Boxes</option -->
                        </select>
                    </div>
                    <!-- button type="button" id="btn-show-logits" class="lafam-btn">Show Groups</button -->
                    <!-- button type="button" id="btn-show-bboxes" class="lafam-btn">Show Bounding Boxes</button -->

                </div>
                <div id="slider-container">
                    <input type="range" id="heatmap-opacity" min="0.0" max="1.0" value="0.5" step="0.05">
                </div>
            </div>
            <div class="predictions-container card">
                <div class="prediction-title">
                    <div>Predictions</div>
                    <button id="clear-selection" disabled title="Clear selection">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
                            <path
                                d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z" />
                        </svg>
                    </button>
                </div>
                <div id="prediction-list">
                    <!-- The prediction list goes here -->
                </div>
            </div>
        </div>
    </section>

    <section style="margin: 10px 10px 20px 10px;">
        <h2>About</h2>
        This interactive demo showcases the Label-free Activation Map for Convolutional Neural Networks. It uses a ResNet50 model trained on the ImageNet dataset (<a href="imagenet_class_index.json" target="_blank">1000 categories</a>) and generates heatmaps from the model's final convolutional layer without relying on labels.

        <h4>Interactions</h4>
        Use your camera, upload an image, or select a pre-defined image from the dropdown menu. To interact with the predictions, you first need to pause the camera first if it's active.
        <ul>
            <li>Click on predictions to see related image regions.</li>
            <li>Click on image regions to view associated predictions. </li>
        </ul>
    </section>

    <section id="debug-section" style="margin: 200px 20px 20px">
        <h3>Debug</h3>
        <button onclick="updateServiceWorker()">Hard reload</button>
        <h4>Available devices</h4>
        <textarea id="devices" style='width: 100%;' rows='10' disabled></textarea>
        <h3>Log</h3>
            <textarea id='log' style='width: 100%;' rows='10' disabled></textarea>


    </section>
    <br>
    <script src="boundingboxes.js"></script>
    <script src="index.js"></script>

</body>

</html>